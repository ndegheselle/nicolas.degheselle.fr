---
const { timelineJobs } = Astro.props;
---

<script>
  import { SVG } from "@svgdotjs/svg.js";

  let canvas;
  let background;
  let texts = {
    main: null,
    top: null,
    bot: null,
  };
  let size = {x: 150, y: 100};

  function createBackground() {
    canvas = SVG().addTo(".svg-container");
    canvas.size("15rem", "10rem").viewbox(0, 0, size.x, size.y);

    console.log("createBackground", size);
    const rect = canvas.rect(size.x, size.y).fill("#000");
    texts.main = canvas.text("7").font({ size: size.y, fill: "#fff" }).move(0, 0);
    texts.top = canvas.text("1").font({ size: size.y / 4, fill: "#fff" }).move(size.x / 3, size.y / 3);
    texts.bot = canvas.text("1").font({ size: size.y / 4, fill: "#fff" }).move(size.x / 3, size.y / 1.8);

    const group = canvas.group();
    group.add(rect);
    group.add(texts.main);
    group.add(texts.top);
    group.add(texts.bot);

    let gradient = canvas.gradient("linear", function (add) {
      add.stop(0, "var(--color-bg-secondary)");
      add.stop(0.5, "var(--color-bg-secondary)");
      add.stop(0.5, "var(--color-primary-dim)");
      add.stop(1, "var(--color-primary)");
    });
    gradient.from(0, 0).to(0, 1);

    canvas.add(group);
    background = canvas.rect(size.x, size.y * 2).fill(gradient).move(0, -size.y/2);
    background.maskWith(group);
  }

  function animate(percent) {
    console.log("animate");
    background.animate().move(0, percent * 15 - 15);
  }

  function updateText(main, top, bot) {
    texts.main.text(main);
    texts.top.text(top);
    texts.bot.text(bot);
  }

  createBackground();
  updateText("2", "years", "10 months");
</script>

<div class="grid is-centered with-gap">
  <div class="col is-auto">
      <div class="svg-container"></div>
  </div>
  <div class="col is-4 description">
    <h2 class="title-complement">
      of practical experience
    </h2>
  </div>
</div>

<style>
  .description {
      overflow: hidden;
      transition: 0.3s;
      max-height: 15rem;
      align-items: center;
  }
  .description.hide {
      flex: 0 0 0;
  }

  .title-complement {
      margin-left: 1rem;       
  }
  .title-complement > h2 {
      color: var(--color-bg-secondary);
      margin: 0;
  }
</style>

<style is:global>
  .svg-container {
    width: 100%;
  }
  svg text {
    font-weight: bold;
    font-family: "Teko", sans-serif;
    line-height: 0.8;
  }
</style>
